<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What the Package Does (One Line, Title Case) • ILS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="What the Package Does (One Line, Title Case)">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ILS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Quality Control Packages

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/index.html">R6Qualitytools</a>
    </li>
    <li>
      <a href="articles/index.html">ILS</a>
    </li>
    <li>
      <a href="articles/index.html">QCR</a>
    </li>
    <li>
      <a href="articles/index.html">QUEE</a>
    </li>
  </ul>
</li>
<li>
  <a href="articles/index.html">Functions ILS</a>
</li>
<li>
  <a href="articles/index.html">Examples of Use</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Acknowledgements

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/index.html">University of A Coruña</a>
    </li>
    <li>
      <a href="articles/index.html">Escuela Politécnica Nacional</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="articles/index.html">
    <span class="fa fa-question-circle-o"></span>

    faq
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="ils-an-r-package-for-statistical-analysis-in-interlaboratory-studies">ILS: An R package for statistical analysis in Interlaboratory Studies<a class="anchor" aria-label="anchor" href="#ils-an-r-package-for-statistical-analysis-in-interlaboratory-studies"></a>
</h1></div>
<!-- badges: start --><!-- badges: end --><div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The main objective of the ILS package is to detect laboratories that provide not consistent results, working simultaneously with different test materials, from the perspective of the Univariate Data Analysis and the Functional Data Analysis (FDA).</p>
<p>The ILS package can identify laboratories that provide significantly different results through the estimation the Mandel’s h and k scalar statistics, based on the ASTM E691 and ISO 5725-2 standards. Additionally, the package has implemented tools to assess the presence of outliers using the Cochran and Grubbs tests.</p>
<p>Furthermore, Analysis of Variance (ANOVA) techniques are provided, both for the cases of fixed and random effects, including confidence intervals for the principles parameters.</p>
<p>Moreover, one of the novelties of this package is the incorporation of tools to perform an ILS from a functional data analysis approach. Accordingly, the functional nature of the data obtained by experimental techniques corresponding to analytical chemistry, applied physics and engineering applications (spectra, thermograms, and sensor signals, among others) is taking into account by implementing the functional extensions of Mandel’s h and k statistics.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of ILSR6V1 from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("ILSR6V1")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/davidtorres1818/ILSR6V1" class="external-link">"ILSR6V1"</a></span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="concepts-across-the-board">Concepts across the board<a class="anchor" aria-label="anchor" href="#concepts-across-the-board"></a>
</h2>
<p><strong>ILS package</strong> addresses several concepts and approaches which will be discussed in detail in the later sections of this article. The most relevant concepts can be found below:</p>
<ul>
<li>
<p><strong>Interlaboratory Study (ILS)</strong>:</p>
<p>This concept can be defined as a control procedure to evaluate the performance of a group of laboratories through a collaborative trials. In an Interlaboratory Study, an adequate number of laboratories are chosen to participate in the experiment with the aim of analyzing the samples and obtain results.</p>
<p>Participating laboratories receive samples (previously homogenized or to be homogenized by the laboratories) for analysis, then, the measurements results of the laboratories are evaluated according to the degree of data variability. Some of the most common factors that may be a cause of variability are: the equipment of laboratories, operators, materials, temperature and humidity, among others.</p>
</li>
<li>
<p><strong>Repeatability and Reproducibility studies (R&amp;R)</strong>:</p>
<p>Repeatability and reproducibility (R&amp;R) studies are a relevant methodology in quality control that assess the accuracy of a measurement system. In addition, R&amp;R studies allow the identification of errors and sources of variation in the measurement process, and are essential to ensure the reliability and accuracy of the results.</p>
<p>This tool of quality control focuses on two key aspects of measurement:</p>
<p><strong>Repeatability:</strong> Repeatability is the variation between successive measurements of the same part or trait by the same person using the same gage. In other words, how much variation do we see in measurements taken by the same person, on the same part, using the same tool.</p>
<p><strong>Reproducibility:</strong> Reproducibility is the difference in the average of the measurements made by different people using the same instrument when measuring the identical characteristics on the same part. In other words, how much variation do we see in measurements taken by different people on the same part using the same too.</p>
</li>
<li>
<p><strong>Consistency tests</strong>:</p>
<p>Several scalar statistical techniques are frequently applied to study the consistency of test results from the different laboratories that participate in an ILS. Standard ASTM E-691 (Standard Practice for Conducting an Interlaboratory Study to Determine the Precision of a Test Method) recommends applying only one graphical technique from Mandel’s k and h statistics [2], while ISO 5725-2 (Accuracy – trueness and precision – of measurement methods and results) recommends, in addition to the graphic technique, to use the Cochran and Grubbs.</p>
<p>The 2 standards mentioned can be consulted in the following accesses:</p>
<p><a href="https://www.astm.org/e0691-21.html" class="external-link">ASTM E-691</a></p>
<p><a href="https://es.scribd.com/document/745647300/NTP-ISO-5725-2-2021-Antecedente-2019" class="external-link">ISO 5725-2</a></p>
</li>
<li>
<p><strong>ANOVA tests</strong>:</p>
<p>The technique of Analysis of Variance (ANOVA), the effect of the laboratory factor over the response can be studied. The variance of repeatability and reproducibility can be also estimated when an ANOVA random effects model is considered, as shown in ISO 5725-2 [1]. On the other hand, if a fixed effect model is fitted, in addition to the F test, multiple comparisons of means can be performed with the Tukey Honest Significant Difference (HSD) method.</p>
</li>
<li>
<p><strong>Functional Data Analysis (FDA)</strong>:</p>
<p>Functional Data Analysis is a relatively new branch of statistics that takes curves as unit of analysis, also surfaces, and volumes defined in a continuum (such as time, or frequency’s domain). Considering the recent advances in computing science, and the increasing amount of data generated by experimental techniques and sensors, the FDA has had a great development in recent years. In fact, we have many statistical methodologies that have been developed and extended to the functional case, such as exploratory analysis, regression, classification, analysis of variance, and time series.</p>
<p>In the specific case of ILS, FDA extensions for Mandels’s h and k have been proposed and described by Flores, in addition to other works where the FDA descriptive analysis had been introduced for ILS studies.</p>
</li>
</ul>
<p><br></p>
</div>
<div class="section level2">
<h2 id="the-r-package-ils">The R Package ILS<a class="anchor" aria-label="anchor" href="#the-r-package-ils"></a>
</h2>
<p>The present ILS library implements and calls some of their routines in order to perform outlier detection in the framework of the Interlaboratory Studies. Thus, regarding to ILS with scalar response, there are some interesting and useful computational tools in R software.</p>
<p>Particularly, the metRology package estimates the uncertainty of the measurement, and performs the required statistical calculations for Interlaboratory Studies, whereas multcomp performs analysis of variance (ANOVA) through F and Tuckey tests.</p>
<p>On the other hand, due to the exponential increasing of FDA available techniques, there are also a continuously increasing number of R libraries devoted to this branch of statistics. Among all of them, the most important and used packages (on which the present proposal is based) are fda.usc, that implements outlier detection techniques and functional ANOVA, among other tools for FDA, and the fda. The present ILS package uses the applications of the before mentioned multcomp and fda.usc</p>
<p>In summary, the functions incorporated to the ILS package to perform Interlaboratory Studies are classified under the following scheme:</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="interlaboratory-studies-standard-approach">Interlaboratory Studies: Standard Approach<a class="anchor" aria-label="anchor" href="#interlaboratory-studies-standard-approach"></a>
</h2>
<p>The ILS package provides two groups of functions made to detect outlying individual results (outlying replicates) and outlying laboratories; for this purpose, the package offers graphical and analytical procedures (statistical hypothesis test).</p>
<p>As mentioned in the previous section, among the methodologies used to evaluate the consistency of laboratory results, we must highlight the r&amp;R studies, which quantify the variability between laboratories (reproducibility) and variability between results (repeatability).</p>
<ul>
<li>
<p><strong>Mandel’s h and k statistic</strong>:</p>
<p>Accordingly with the repeatability and reproducibility concepts, this statistics are used in ILS to detect laboratories that provide inconsistent results. The h statistic explains the variability between the laboratories, that is, estimates the bias, which is the difference of the means of each laboratory with respect to the global mean, while the k statistic estimates the variability within the laboratories, comparing the repeatability corresponding to each laboratory.</p>
<p>The decision rule for detecting whether a laboratory is inconsistent is based on the comparison between the value of the h or k statistic and the critical value, which is normally calculated with a significance level of 0.5% (as recommended by ASTM E-691).</p>
</li>
<li>
<p><strong>Cochran and Grubbs test</strong>:</p>
<p>The aim oh these tests is to examine the consistency within a laboratory, whereas the Grubbs test is commonly used to examine consistency between laboratories. The Grubbs test can also be used as a consistency test for the results obtained in a laboratory using identical materials. These tests are recommended by ISO 5725-2.</p>
</li>
</ul>
<p>Accordingly, consistency tests and identification of atypical results must be performed previously to ANOVA analysis. There are two possible scenarios in which the presence of outliers can be evaluated: the first is that the results of one laboratory deviates from the others in terms of precision, that is, when the measurements made by a laboratory significantly differ with respect to the measurements obtained by other laboratories. The second scenario is related with the identification of outliers in a laboratory for a certain level.</p>
<p>The statistics and tests recommended by ISO 5725-2 and ASTM E-691 are described below.</p>
<ul>
<li>
<p><strong>Mandel’s h statistic and Grubbs test</strong>:</p>
<p>If a laboratory is identified as an outlier, after applying the h statistic and the Grubbs test to different levels within a laboratory, this is an evidence of the presence of a laboratory high bias (due to a high systematic error in calibration, or errors in the equations used to compute the results).</p>
</li>
<li>
<p><strong>Mandel’s k statistic and Cochran test</strong>:</p>
<p>The Cochran test only evaluates the highest value in a series of variances. If a laboratory is detected as an outlier, using the k statistic or with the Cochran test, this indicates that the variance within the laboratory is high (due to lack of familiarity with the analytical method, differences of appreciation among operators, inadequate equipment, equipment in poor state, or careless execution), in which case the total of results collected by this laboratory should be rejected and taken out of the study.</p>
<p>The detection of inconsistent laboratories must be repeated until it stops reporting outliers. However, the consistency tests should be used with caution, because if this process is carried out in excess, could lead to false outlier identification.</p>
</li>
</ul>
<p><br></p>
</div>
<div class="section level2">
<h2 id="interlaboratory-studies-new-fda-approach">Interlaboratory Studies: New FDA Approach<a class="anchor" aria-label="anchor" href="#interlaboratory-studies-new-fda-approach"></a>
</h2>
<p>The ILS package have some techniques developed to check if inconsistent laboratories are detected either by outliers in the within-laboratory or in between-laboratory variability.</p>
<ul><li>
<p><strong>Hypothesis of reproducibility and repeatability</strong>:</p>
<p>To test the hypothesis that there are no differences in the measurements between the laboratories in a study, functional statistics Hl(t) and Kl(t) are estimated for each laboratory.</p>
<p>The null hypothesis of reproducibility states that …</p>
<p>…….</p>
<p>To evaluate the reproducibility of the laboratory results, the H(t) statistic is calculated as follows:</p>
<p>…….</p>
<p>To test the reproducibility hypothesis, the test statistic dH</p>
<p>…….</p>
<p>On the other hand, the null hypothesis of repeatability is:</p>
<p>…….</p>
<p>The repeatability test is based on the K(t) statistic, expressed as:</p>
<p>…….</p>
<p>The test statistic is dK.</p>
</li></ul>
<p>A bootstrap procedure to reproduce the distribution of these statistics under the corresponding null hypothesis is proposed in… This procedure provides the approximation of the critical values cK and cH of the test statistics dH and dK, respectively. Additionally, confidence bands for the functional statistics H(t) and K(t) can be computed (determined by the envelope of their bootstrap counterparts with a norm less than the corresponding critical value).</p>
<p><br><br><br></p>
<p>This is a basic example which shows you how to solve a common problem:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/davidtorres1818/ILSR6V1" class="external-link">ILSR6V1</a></span><span class="op">)</span></span>
<span><span class="co">## basic example code</span></span></code></pre></div>
<p>What is special about using <code>README.Rmd</code> instead of just <code>README.md</code>? You can include R chunks like so:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cars</span><span class="op">)</span></span>
<span><span class="co">#&gt;      speed           dist       </span></span>
<span><span class="co">#&gt;  Min.   : 4.0   Min.   :  2.00  </span></span>
<span><span class="co">#&gt;  1st Qu.:12.0   1st Qu.: 26.00  </span></span>
<span><span class="co">#&gt;  Median :15.0   Median : 36.00  </span></span>
<span><span class="co">#&gt;  Mean   :15.4   Mean   : 42.98  </span></span>
<span><span class="co">#&gt;  3rd Qu.:19.0   3rd Qu.: 56.00  </span></span>
<span><span class="co">#&gt;  Max.   :25.0   Max.   :120.00</span></span></code></pre></div>
<p>You’ll still need to render <code>README.Rmd</code> regularly, to keep <code>README.md</code> up-to-date. <code><a href="https://devtools.r-lib.org/reference/build_rmd.html" class="external-link">devtools::build_readme()</a></code> is handy for this.</p>
<p>You can also embed plots, for example:</p>
<p><img src="reference/figures/README-pressure-1.png" width="100%"></p>
<p>In that case, don’t forget to commit and push the resulting figure files, so they display on GitHub and CRAN.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/davidtorres1818/ILSR6V1/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/davidtorres1818/ILSR6V1/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ILSR6V1</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>David Cardenas <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by David Cardenas.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
