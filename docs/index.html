<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What the Package Does (One Line, Title Case) • ILS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="What the Package Does (One Line, Title Case)">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ILS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Quality Control Packages

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/index.html">R6qualitytools</a>
    </li>
    <li>
      <a href="articles/index.html">ILS</a>
    </li>
    <li>
      <a href="articles/index.html">QCR</a>
    </li>
    <li>
      <a href="articles/index.html">QUEUE</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Functions ILS

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/index.html">Sample data</a>
    </li>
    <li>
      <a href="articles/index.html">Class constructors</a>
    </li>
    <li>
      <a href="articles/index.html">Model / Formula</a>
    </li>
    <li>
      <a href="articles/index.html">Functions R6</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples of Use

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/index.html">Clinical study of blood glucose measurement</a>
    </li>
    <li>
      <a href="articles/index.html">Characterization of materials by thermogravimetric analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Acknowledgements

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/index.html">University of La Coruña</a>
    </li>
    <li>
      <a href="articles/index.html">Escuela Politécnica Nacional</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="articles/index.html">
    <span class="fa fa-question-circle-o"></span>

    faq
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="ils-an-r-package-for-statistical-analysis-in-interlaboratory-studies">ILS: An R package for statistical analysis in Interlaboratory Studies<a class="anchor" aria-label="anchor" href="#ils-an-r-package-for-statistical-analysis-in-interlaboratory-studies"></a>
</h1></div>
<!-- badges: start --><!-- badges: end --><div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The main objective of the ILS package is to detect laboratories that provide not consistent results, working simultaneously with different test materials, from the perspective of the Univariate Data Analysis and the Functional Data Analysis (FDA).</p>
<p>The ILS package can identify laboratories that provide significantly different results through the estimation the Mandel’s h and k scalar statistics, based on the ASTM E691 and ISO 5725-2 standards. Additionally, the package has implemented tools to assess the presence of outliers using the Cochran and Grubbs tests.</p>
<p>Furthermore, Analysis of Variance (ANOVA) techniques are provided, both for the cases of fixed and random effects, including confidence intervals for the principles parameters.</p>
<p>Moreover, one of the novelties of this package is the incorporation of tools to perform an ILS from a functional data analysis approach. Accordingly, the functional nature of the data obtained by experimental techniques corresponding to analytical chemistry, applied physics and engineering applications (spectra, thermograms, and sensor signals, among others) is taking into account by implementing the functional extensions of Mandel’s h and k statistics.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="concepts-across-the-board">Concepts across the board<a class="anchor" aria-label="anchor" href="#concepts-across-the-board"></a>
</h2>
<p><strong>ILS package</strong> addresses several concepts and approaches which will be discussed in detail in the later sections of this article. The most relevant concepts can be found below:</p>
<ul>
<li>
<p><strong>Interlaboratory Study (ILS)</strong></p>
<p>This concept can be defined as a control procedure to evaluate the performance of a group of laboratories through a collaborative trials. In an Interlaboratory Study, an adequate number of laboratories are chosen to participate in the experiment with the aim of analyzing the samples and obtain results.</p>
<p>Participating laboratories receive samples (previously homogenized or to be homogenized by the laboratories) for analysis, then, the measurements results of the laboratories are evaluated according to the degree of data variability. Some of the most common factors that may be a cause of variability are: the equipment of laboratories, operators, materials, temperature and humidity, among others.</p>
</li>
<li>
<p><strong>Repeatability and Reproducibility studies (R&amp;R)</strong></p>
<p>Repeatability and reproducibility (R&amp;R) studies are a relevant methodology in quality control that assess the accuracy of a measurement system. In addition, R&amp;R studies allow the identification of errors and sources of variation in the measurement process, and are essential to ensure the reliability and accuracy of the results.</p>
<p>This tool of quality control focuses on two key aspects of measurement:</p>
<p><strong>Repeatability:</strong> Repeatability is the variation between successive measurements of the same part or trait by the same person using the same gage. In other words, how much variation do we see in measurements taken by the same person, on the same part, using the same tool.</p>
<p><strong>Reproducibility:</strong> Reproducibility is the difference in the average of the measurements made by different people using the same instrument when measuring the identical characteristics on the same part. In other words, how much variation do we see in measurements taken by different people on the same part using the same too.</p>
</li>
<li>
<p><strong>Consistency tests</strong></p>
<p>Several scalar statistical techniques are frequently applied to study the consistency of test results from the different laboratories that participate in an ILS. Standard ASTM E-691 (Standard Practice for Conducting an Interlaboratory Study to Determine the Precision of a Test Method) recommends applying only one graphical technique from Mandel’s k and h statistics [2], while ISO 5725-2 (Accuracy – trueness and precision – of measurement methods and results) recommends, in addition to the graphic technique, to use the Cochran and Grubbs.</p>
<p>The 2 standards mentioned can be consulted in the following accesses:</p>
<p><a href="https://www.astm.org/e0691-21.html" class="external-link">ASTM E-691</a></p>
<p><a href="https://es.scribd.com/document/745647300/NTP-ISO-5725-2-2021-Antecedente-2019" class="external-link">ISO 5725-2</a></p>
</li>
<li>
<p><strong>ANOVA tests</strong></p>
<p>The technique of Analysis of Variance (ANOVA), the effect of the laboratory factor over the response can be studied. The variance of repeatability and reproducibility can be also estimated when an ANOVA random effects model is considered, as shown in ISO 5725-2 [1]. On the other hand, if a fixed effect model is fitted, in addition to the F test, multiple comparisons of means can be performed with the Tukey Honest Significant Difference (HSD) method.</p>
</li>
<li>
<p><strong>Functional Data Analysis (FDA)</strong>:</p>
<p>Functional Data Analysis is a relatively new branch of statistics that takes curves as unit of analysis, also surfaces, and volumes defined in a continuum (such as time, or frequency’s domain). Considering the recent advances in computing science, and the increasing amount of data generated by experimental techniques and sensors, the FDA has had a great development in recent years. In fact, we have many statistical methodologies that have been developed and extended to the functional case, such as exploratory analysis, regression, classification, analysis of variance, and time series.</p>
<p>In the specific case of ILS, FDA extensions for Mandels’s h and k have been proposed and described by Flores, in addition to other works where the FDA descriptive analysis had been introduced for ILS studies.</p>
</li>
</ul>
<p><br></p>
</div>
<div class="section level2">
<h2 id="the-r-package-ils">The R Package ILS<a class="anchor" aria-label="anchor" href="#the-r-package-ils"></a>
</h2>
<p>The present ILS library implements and calls some of their routines in order to perform outlier detection in the framework of the Interlaboratory Studies. Thus, regarding to ILS with scalar response, there are some interesting and useful computational tools in R software.</p>
<p>Particularly, the metRology package estimates the uncertainty of the measurement, and performs the required statistical calculations for Interlaboratory Studies, whereas multcomp performs analysis of variance (ANOVA) through F and Tuckey tests.</p>
<p>On the other hand, due to the exponential increasing of FDA available techniques, there are also a continuously increasing number of R libraries devoted to this branch of statistics. Among all of them, the most important and used packages (on which the present proposal is based) are fda.usc, that implements outlier detection techniques and functional ANOVA, among other tools for FDA, and the fda. The present ILS package uses the applications of the before mentioned multcomp and fda.usc</p>
<p>In summary, the functions incorporated to the ILS package to perform Interlaboratory Studies are classified under the following scheme:</p>
<p>…….</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="interlaboratory-studies-standard-approach">Interlaboratory Studies: Standard Approach<a class="anchor" aria-label="anchor" href="#interlaboratory-studies-standard-approach"></a>
</h2>
<p>The ILS package provides two groups of functions made to detect outlying individual results (outlying replicates) and outlying laboratories; for this purpose, the package offers graphical and analytical procedures (statistical hypothesis test).</p>
<p>As mentioned in the previous section, among the methodologies used to evaluate the consistency of laboratory results, we must highlight the r&amp;R studies, which quantify the variability between laboratories (reproducibility) and variability between results (repeatability).</p>
<ul>
<li>
<p><strong>Mandel’s h and k statistic</strong></p>
<p>Accordingly with the repeatability and reproducibility concepts, this statistics are used in ILS to detect laboratories that provide inconsistent results. The h statistic explains the variability between the laboratories, that is, estimates the bias, which is the difference of the means of each laboratory with respect to the global mean, while the k statistic estimates the variability within the laboratories, comparing the repeatability corresponding to each laboratory.</p>
<p>The decision rule for detecting whether a laboratory is inconsistent is based on the comparison between the value of the h or k statistic and the critical value, which is normally calculated with a significance level of 0.5% (as recommended by ASTM E-691).</p>
</li>
<li>
<p><strong>Cochran and Grubbs test</strong></p>
<p>The aim oh these tests is to examine the consistency within a laboratory, whereas the Grubbs test is commonly used to examine consistency between laboratories. The Grubbs test can also be used as a consistency test for the results obtained in a laboratory using identical materials. These tests are recommended by ISO 5725-2.</p>
</li>
</ul>
<p>Accordingly, consistency tests and identification of atypical results must be performed previously to ANOVA analysis. There are two possible scenarios in which the presence of outliers can be evaluated: the first is that the results of one laboratory deviates from the others in terms of precision, that is, when the measurements made by a laboratory significantly differ with respect to the measurements obtained by other laboratories. The second scenario is related with the identification of outliers in a laboratory for a certain level.</p>
<p><br></p>
<p>The statistics and tests recommended by ISO 5725-2 and ASTM E-691 are described below.</p>
<ul>
<li>
<p><strong>Mandel’s h statistic and Grubbs test</strong></p>
<p>If a laboratory is identified as an outlier, after applying the h statistic and the Grubbs test to different levels within a laboratory, this is an evidence of the presence of a laboratory high bias (due to a high systematic error in calibration, or errors in the equations used to compute the results).</p>
</li>
<li>
<p><strong>Mandel’s k statistic and Cochran test</strong></p>
<p>The Cochran test only evaluates the highest value in a series of variances. If a laboratory is detected as an outlier, using the k statistic or with the Cochran test, this indicates that the variance within the laboratory is high (due to lack of familiarity with the analytical method, differences of appreciation among operators, inadequate equipment, equipment in poor state, or careless execution), in which case the total of results collected by this laboratory should be rejected and taken out of the study.</p>
<p>The detection of inconsistent laboratories must be repeated until it stops reporting outliers. However, the consistency tests should be used with caution, because if this process is carried out in excess, could lead to false outlier identification.</p>
</li>
</ul>
<p><br></p>
</div>
<div class="section level2">
<h2 id="interlaboratory-studies-new-fda-approach">Interlaboratory Studies: New FDA Approach<a class="anchor" aria-label="anchor" href="#interlaboratory-studies-new-fda-approach"></a>
</h2>
<p>The ILS package have some techniques developed to check if inconsistent laboratories are detected either by outliers in the within-laboratory or in between-laboratory variability.</p>
<ul><li>
<p><strong>Hypothesis of reproducibility and repeatability</strong>:</p>
<p>To test the hypothesis that there are no differences in the measurements between the laboratories in a study, functional statistics Hl(t) and Kl(t) are estimated for each laboratory.</p>
<p>The null hypothesis of reproducibility states that</p>
<p>…….</p>
<p>To evaluate the reproducibility of the laboratory results, the H(t) statistic is calculated as follows:</p>
<p>…….</p>
<p>To test the reproducibility hypothesis, the test statistic dH</p>
<p>…….</p>
<p>On the other hand, the null hypothesis of repeatability is:</p>
<p>…….</p>
<p>The repeatability test is based on the K(t) statistic, expressed as:</p>
<p>…….</p>
<p>The test statistic is dK.</p>
</li></ul>
<p><br></p>
<p>A bootstrap procedure to reproduce the distribution of these statistics under the corresponding null hypothesis is proposed in … This procedure provides the approximation of the critical values cK and cH of the test statistics dH and dK, respectively. Additionally, confidence bands for the functional statistics H(t) and K(t) can be computed (determined by the envelope of their bootstrap counterparts with a norm less than the corresponding critical value).</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="ils-package-installation">ILS package Installation<a class="anchor" aria-label="anchor" href="#ils-package-installation"></a>
</h2>
<p>You can install the development version of ILSR6V1 from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("ILSR6V1")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/davidtorres1818/ILSR6V1" class="external-link">"ILSR6V1"</a></span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2"><h2 id="ils-package-practical-examples">ILS package Practical examples<a class="anchor" aria-label="anchor" href="#ils-package-practical-examples"></a>
</h2></div>
<div class="section level2">
<h2 id="1-clinical-study-of-blood-glucose-measurement">1) Clinical study of blood glucose measurement<a class="anchor" aria-label="anchor" href="#1-clinical-study-of-blood-glucose-measurement"></a>
</h2>
<p><br></p>
<ul><li><strong>Graphical and analytical statistics</strong></li></ul>
<p>The Glucose dataset corresponds to the serum glucose test (measurements of the concentration of glucose in the blood used to control the diabetes). In this study, eight laboratories where involved, and five different tests were performed on blood samples labelled with different references, ranging from a low sugar content to a very high one. Three replicates were obtained for each sample.</p>
<p>Each of these laboratories measured five different concentration levels (A, B, C, D, E) of a given material, and at each of these levels, three measurements were taken (3 replicates). Each laboratory provided a total of 15 measurements (3 for each level), therefore, with 8 laboratories involved, 120 measurements were obtained.</p>
<p>In order to access this dataset, the ILS package installing and loading is required. Once loading is performed, the Glucose data.frame object is called using the following instructions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mflores72000/ILS/" class="external-link">ILS</a></span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Glucose"</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>The first step to perform an analysis with the ILS package consist on using the function ils.qcdata() (quality control data) that receives a data.frame as an argument. By default, the first column of the data frame must contain the response variable, the second column the replicates, the third column corresponds to the tested material, while the fourth column includes the laboratories where the procedure was performed.</p>
<p>For instance, the following code creates an object qcdata (of class ils.qcdata) and uses the summary() method to obtain descriptive statistics information of the dataset.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qcdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/lab.qcdata.html" class="external-link">lab.qcdata</a></span><span class="op">(</span><span class="va">Glucose</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">qcdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;        x          replicate material   laboratory</span></span>
<span><span class="co">#&gt;  Min.   : 39.02   1:40      A:24     Lab1   :15  </span></span>
<span><span class="co">#&gt;  1st Qu.: 78.45   2:40      B:24     Lab2   :15  </span></span>
<span><span class="co">#&gt;  Median :135.03   3:40      C:24     Lab3   :15  </span></span>
<span><span class="co">#&gt;  Mean   :149.09             D:24     Lab4   :15  </span></span>
<span><span class="co">#&gt;  3rd Qu.:196.66             E:24     Lab5   :15  </span></span>
<span><span class="co">#&gt;  Max.   :309.40                      Lab6   :15  </span></span>
<span><span class="co">#&gt;                                      (Other):30</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">qcdata</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Laboratory"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Glucose concentration in blood"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_2-1.png" width="100%"></p>
<p>The figure shows the obtained values for each laboratory and material. It can be noted that the blood glucose level increases from material A to D and there is more variability between the results for each laboratory from material C to material E.</p>
<p><br></p>
<p>In order to calculate the graphical and analytical statistics for the scalar (univariate) case, first, the function lab.qcs() (quality control statistics) has to be used. This function returns the estimates of the statistical required measures (mean, variance, etc.) for computing the Mandel’s h and k statistics, as well as the required measures to perform the Cochran and Grubbs tests.</p>
<p>In the following commands, the lab.qcs() function uses the qcdata object to create the qcstat object that estimates both the mean and the global deviation from the results of all laboratories and all materials. The repeatability deviation (Sr), the deviation between the means of laboratories (SB), and the reproducibility deviation (SR) for each material are also estimated (following ASTM E-691)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qcstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/lab.qcs.html" class="external-link">lab.qcs</a></span><span class="op">(</span><span class="va">qcdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">qcstat</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of laboratories:  8</span></span>
<span><span class="co">#&gt; Number of materials:  5</span></span>
<span><span class="co">#&gt; Number of replicate:  3</span></span>
<span><span class="co">#&gt; Summary for Laboratory (means):</span></span>
<span><span class="co">#&gt;        Lab1      Lab2      Lab3      Lab4      Lab5      Lab6      Lab7</span></span>
<span><span class="co">#&gt; A  41.28333  41.44000  41.45000  41.45667  41.46333  42.02000  40.45667</span></span>
<span><span class="co">#&gt; B  78.31667  79.23333  79.90333  80.96333  78.69000  79.89333  79.51667</span></span>
<span><span class="co">#&gt; C 133.19667 135.40667 134.59000 140.83000 133.26667 136.61667 132.49333</span></span>
<span><span class="co">#&gt; D 193.65000 195.10667 192.09000 197.21333 193.05000 197.24333 191.26000</span></span>
<span><span class="co">#&gt; E 293.25333 298.91667 292.67000 295.82000 293.56333 294.95667 290.13667</span></span>
<span><span class="co">#&gt;        Lab8</span></span>
<span><span class="co">#&gt; A  42.57667</span></span>
<span><span class="co">#&gt; B  80.34667</span></span>
<span><span class="co">#&gt; C 134.71000</span></span>
<span><span class="co">#&gt; D 198.12333</span></span>
<span><span class="co">#&gt; E 296.62000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary for Laboratory (Deviations):</span></span>
<span><span class="co">#&gt;        Lab1      Lab2      Lab3      Lab4      Lab5     Lab6     Lab7      Lab8</span></span>
<span><span class="co">#&gt; A 0.2230097 0.4850773 1.0608016 1.8117763 0.3666515 1.408119 1.247811 0.8224557</span></span>
<span><span class="co">#&gt; B 0.1582193 1.3268509 0.8303212 2.7660863 0.7754354 1.636592 2.059935 0.5064912</span></span>
<span><span class="co">#&gt; C 0.5909597 2.1679791 1.7287857 6.6200227 1.1987215 1.287025 2.124296 1.0343597</span></span>
<span><span class="co">#&gt; D 0.0600000 4.6824068 1.5932043 1.9365519 1.8826311 1.649616 3.817709 2.4637844</span></span>
<span><span class="co">#&gt; E 0.7266590 9.1869055 2.7101107 0.8835723 0.9543759 4.034282 3.304184 1.6479078</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary for Material:</span></span>
<span><span class="co">#&gt;        mean         S      S_r       S_B      S_R</span></span>
<span><span class="co">#&gt; A  41.51833 0.5543251 1.063224 0.6061274 1.058783</span></span>
<span><span class="co">#&gt; B  79.60792 0.8664835 1.496071 0.8627346 1.495481</span></span>
<span><span class="co">#&gt; C 135.13875 1.9071053 2.750879 2.6566872 3.478919</span></span>
<span><span class="co">#&gt; D 194.71708 1.4262962 2.625065 2.5950046 3.365713</span></span>
<span><span class="co">#&gt; E 294.49208 2.8067799 3.934974 2.6931364 4.192334</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">qcstat</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Deviations"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Material"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_3-1.png" width="100%"> In the figure presented, the values of S (the global deviation of all laboratories), Sr (the repeatability’s deviation), SR (reproducibility’s deviation) and SB (the deviation between the means of the laboratories) are shown for each material. A greater variability can be noted from material C to material E. Materials C and D have a greater variability between the results of the laboratories (SR) and within them (Sr).</p>
<p><br></p>
<ul><li><strong>Consistency tests</strong></li></ul>
<p>First, an analysis of the variability for each laboratory will be performed. For this purpose, the k statistic (k.qcs()) and the Cochran test (cochran.test()) will be used to identify if there is any laboratory with non-consistent results. Subsequently, the h statistic (h.qcs()) and the Grubbs test (grubbs.test()) will be used to perform an analysis to evaluate inter-laboratory variability.</p>
<p>The following code creates an object containing the scalar Mandel’s k statistic for each laboratory and material, which is subsequently plotted:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/k.qcs.html" class="external-link">k.qcs</a></span><span class="op">(</span><span class="va">qcdata</span>, alpha <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_4-1.png" width="100%"></p>
<p><br><br></p>
<p>In the figure above, the dotted line represents the critical value equal to 2.06, obtained for p = 8, n = 15 and α = 0.005 (following the ASTM standard). Hence, outliers were detected for the laboratory 2, when testing the material 5, and for material 3, when is tested by the laboratory 4, since the corresponding values of the k statistics were greater than the critical value.</p>
<p>The summary() method prints the violations matrix. If an entry of this matrix is FALSE, the laboratory reports outlying results for the corresponding material at the specified significance level.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of laboratories:  8</span></span>
<span><span class="co">#&gt; Number of materials:  5</span></span>
<span><span class="co">#&gt; Number of replicate:  3</span></span>
<span><span class="co">#&gt; Critical value:  2.06084</span></span>
<span><span class="co">#&gt; Beyond limits of control: </span></span>
<span><span class="co">#&gt;         A    B     C    D     E</span></span>
<span><span class="co">#&gt; Lab1 TRUE TRUE  TRUE TRUE  TRUE</span></span>
<span><span class="co">#&gt; Lab2 TRUE TRUE  TRUE TRUE FALSE</span></span>
<span><span class="co">#&gt; Lab3 TRUE TRUE  TRUE TRUE  TRUE</span></span>
<span><span class="co">#&gt; Lab4 TRUE TRUE FALSE TRUE  TRUE</span></span>
<span><span class="co">#&gt; Lab5 TRUE TRUE  TRUE TRUE  TRUE</span></span>
<span><span class="co">#&gt; Lab6 TRUE TRUE  TRUE TRUE  TRUE</span></span>
<span><span class="co">#&gt; Lab7 TRUE TRUE  TRUE TRUE  TRUE</span></span>
<span><span class="co">#&gt; Lab8 TRUE TRUE  TRUE TRUE  TRUE</span></span></code></pre></div>
<p>The Cochran’s test can be performed with the cochran.test() function. In this case study, with the maximum variance for each material, no laboratory was considered inconsistent, since the critical value was 0.52 and the p-values for each material exceeded the 5% significance level.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ILS/man/cochran.test.html" class="external-link">cochran.test</a></span><span class="op">(</span><span class="va">qcdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test Cochran </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Critical value: 0.5156875 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Alpha test: 0.00625 </span></span>
<span><span class="co">#&gt;   Smax Material          C p.value</span></span>
<span><span class="co">#&gt; 1 Lab4        A 0.20033869  0.0231</span></span>
<span><span class="co">#&gt; 2 Lab4        B 0.15447962  0.0102</span></span>
<span><span class="co">#&gt; 3 Lab4        C 0.10935197  0.0029</span></span>
<span><span class="co">#&gt; 4 Lab2        D 0.08493741  0.0010</span></span>
<span><span class="co">#&gt; 5 Lab2        E 0.07416440  0.0005</span></span></code></pre></div>
<p>We proceeded to use the methods h.qcs() and plot() to estimate and plot the h statistics for each laboratory and material. The critical value was 2.15, therefore, from this result it can be seen in Figure 6 that laboratories 4, 7 and 8 presented non-consistent results at a significance level of α = 0.005.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/h.qcs.html" class="external-link">h.qcs</a></span><span class="op">(</span><span class="va">qcdata</span>, alpha <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_7-1.png" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of laboratories:  8</span></span>
<span><span class="co">#&gt; Number of materials:  5</span></span>
<span><span class="co">#&gt; Number of replicate:  3</span></span>
<span><span class="co">#&gt; Critical value:  2.152492</span></span>
<span><span class="co">#&gt; Beyond limits of control: </span></span>
<span><span class="co">#&gt;         A    B     C     D    E</span></span>
<span><span class="co">#&gt; Lab1 TRUE TRUE  TRUE  TRUE TRUE</span></span>
<span><span class="co">#&gt; Lab2 TRUE TRUE  TRUE  TRUE TRUE</span></span>
<span><span class="co">#&gt; Lab3 TRUE TRUE  TRUE  TRUE TRUE</span></span>
<span><span class="co">#&gt; Lab4 TRUE TRUE FALSE  TRUE TRUE</span></span>
<span><span class="co">#&gt; Lab5 TRUE TRUE  TRUE  TRUE TRUE</span></span>
<span><span class="co">#&gt; Lab6 TRUE TRUE  TRUE  TRUE TRUE</span></span>
<span><span class="co">#&gt; Lab7 TRUE TRUE  TRUE FALSE TRUE</span></span>
<span><span class="co">#&gt; Lab8 TRUE TRUE  TRUE FALSE TRUE</span></span></code></pre></div>
<p><br></p>
<ul><li><strong>Outliers detection</strong></li></ul>
<p>Laboratories with very extreme results were detected by using the Grubbs’ test, i.e. laboratories defined by very large or small results (glucose content).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ILS/man/grubbs.test.html" class="external-link">grubbs.test</a></span><span class="op">(</span><span class="va">qcdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test Grubbs </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Critical value: 1.154478 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Alpha test: 0.00625 </span></span>
<span><span class="co">#&gt;   Material Gmax    G.max p.value.max Gmin    G.min p.value.min</span></span>
<span><span class="co">#&gt; 1        A Lab8 1.909229      0.0489 Lab7 1.915242      0.0485</span></span>
<span><span class="co">#&gt; 2        B Lab4 1.564273      0.0809 Lab1 1.490219      0.0899</span></span>
<span><span class="co">#&gt; 3        C Lab4 2.984235      0.0102 Lab7 1.387137      0.1040</span></span>
<span><span class="co">#&gt; 4        D Lab8 2.388179      0.0241 Lab7 2.423819      0.0229</span></span>
<span><span class="co">#&gt; 5        E Lab2 1.576391      0.0795 Lab7 1.551749      0.0823</span></span></code></pre></div>
<p>Once the outlier laboratories are removed, one-way ANOVA analysis and mean comparison test can be performed. The ILS package provides function ils.aov() to perform an analysis of variance considering random or fixed effects of the laboratory factor depending on the value of the random argument. By setting this parameter to TRUE, a random effects one-way ANOVA is done for each material, providing the corresponding F tests and confidence intervals for the variances. For instance, the following code shows an example using the results of one material for the sake of simplicity.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Glucose2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Glucose</span>, <span class="va">Material</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span></span>
<span><span class="va">Glucose2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/lab.qcdata.html" class="external-link">lab.qcdata</a></span><span class="op">(</span><span class="va">Glucose2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ILS/man/lab.aov.html" class="external-link">lab.aov</a></span><span class="op">(</span><span class="va">Glucose2</span>, random <span class="op">=</span> <span class="cn">TRUE</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  AOV of Material: 1            Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; laboratory   7  7.715   1.102   0.975  0.482</span></span>
<span><span class="co">#&gt; Residuals   16 18.087   1.130               </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simultaneous Tests for General Linear Hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fit: aov(formula = y ~ laboratory, data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Hypotheses:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; Lab2 - Lab1 == 0  0.156667   0.868119   0.180    1.000</span></span>
<span><span class="co">#&gt; Lab3 - Lab1 == 0  0.166667   0.868119   0.192    1.000</span></span>
<span><span class="co">#&gt; Lab4 - Lab1 == 0  0.173333   0.868119   0.200    1.000</span></span>
<span><span class="co">#&gt; Lab5 - Lab1 == 0  0.180000   0.868119   0.207    1.000</span></span>
<span><span class="co">#&gt; Lab6 - Lab1 == 0  0.736667   0.868119   0.849    0.987</span></span>
<span><span class="co">#&gt; Lab7 - Lab1 == 0 -0.826667   0.868119  -0.952    0.975</span></span>
<span><span class="co">#&gt; Lab8 - Lab1 == 0  1.293333   0.868119   1.490    0.802</span></span>
<span><span class="co">#&gt; Lab3 - Lab2 == 0  0.010000   0.868119   0.012    1.000</span></span>
<span><span class="co">#&gt; Lab4 - Lab2 == 0  0.016667   0.868119   0.019    1.000</span></span>
<span><span class="co">#&gt; Lab5 - Lab2 == 0  0.023333   0.868119   0.027    1.000</span></span>
<span><span class="co">#&gt; Lab6 - Lab2 == 0  0.580000   0.868119   0.668    0.997</span></span>
<span><span class="co">#&gt; Lab7 - Lab2 == 0 -0.983333   0.868119  -1.133    0.940</span></span>
<span><span class="co">#&gt; Lab8 - Lab2 == 0  1.136667   0.868119   1.309    0.883</span></span>
<span><span class="co">#&gt; Lab4 - Lab3 == 0  0.006667   0.868119   0.008    1.000</span></span>
<span><span class="co">#&gt; Lab5 - Lab3 == 0  0.013333   0.868119   0.015    1.000</span></span>
<span><span class="co">#&gt; Lab6 - Lab3 == 0  0.570000   0.868119   0.657    0.997</span></span>
<span><span class="co">#&gt; Lab7 - Lab3 == 0 -0.993333   0.868119  -1.144    0.937</span></span>
<span><span class="co">#&gt; Lab8 - Lab3 == 0  1.126667   0.868119   1.298    0.887</span></span>
<span><span class="co">#&gt; Lab5 - Lab4 == 0  0.006667   0.868119   0.008    1.000</span></span>
<span><span class="co">#&gt; Lab6 - Lab4 == 0  0.563333   0.868119   0.649    0.997</span></span>
<span><span class="co">#&gt; Lab7 - Lab4 == 0 -1.000000   0.868119  -1.152    0.934</span></span>
<span><span class="co">#&gt; Lab8 - Lab4 == 0  1.120000   0.868119   1.290    0.890</span></span>
<span><span class="co">#&gt; Lab6 - Lab5 == 0  0.556667   0.868119   0.641    0.998</span></span>
<span><span class="co">#&gt; Lab7 - Lab5 == 0 -1.006667   0.868119  -1.160    0.932</span></span>
<span><span class="co">#&gt; Lab8 - Lab5 == 0  1.113333   0.868119   1.282    0.893</span></span>
<span><span class="co">#&gt; Lab7 - Lab6 == 0 -1.563333   0.868119  -1.801    0.629</span></span>
<span><span class="co">#&gt; Lab8 - Lab6 == 0  0.556667   0.868119   0.641    0.998</span></span>
<span><span class="co">#&gt; Lab8 - Lab7 == 0  2.120000   0.868119   2.442    0.286</span></span>
<span><span class="co">#&gt; (Adjusted p values reported -- single-step method)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simultaneous Confidence Intervals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fit: aov(formula = y ~ laboratory, data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quantile = 3.4594</span></span>
<span><span class="co">#&gt; 95% family-wise confidence level</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Hypotheses:</span></span>
<span><span class="co">#&gt;                  Estimate  lwr       upr      </span></span>
<span><span class="co">#&gt; Lab2 - Lab1 == 0  0.156667 -2.846510  3.159843</span></span>
<span><span class="co">#&gt; Lab3 - Lab1 == 0  0.166667 -2.836510  3.169843</span></span>
<span><span class="co">#&gt; Lab4 - Lab1 == 0  0.173333 -2.829843  3.176510</span></span>
<span><span class="co">#&gt; Lab5 - Lab1 == 0  0.180000 -2.823176  3.183176</span></span>
<span><span class="co">#&gt; Lab6 - Lab1 == 0  0.736667 -2.266510  3.739843</span></span>
<span><span class="co">#&gt; Lab7 - Lab1 == 0 -0.826667 -3.829843  2.176510</span></span>
<span><span class="co">#&gt; Lab8 - Lab1 == 0  1.293333 -1.709843  4.296510</span></span>
<span><span class="co">#&gt; Lab3 - Lab2 == 0  0.010000 -2.993176  3.013176</span></span>
<span><span class="co">#&gt; Lab4 - Lab2 == 0  0.016667 -2.986510  3.019843</span></span>
<span><span class="co">#&gt; Lab5 - Lab2 == 0  0.023333 -2.979843  3.026510</span></span>
<span><span class="co">#&gt; Lab6 - Lab2 == 0  0.580000 -2.423176  3.583176</span></span>
<span><span class="co">#&gt; Lab7 - Lab2 == 0 -0.983333 -3.986510  2.019843</span></span>
<span><span class="co">#&gt; Lab8 - Lab2 == 0  1.136667 -1.866510  4.139843</span></span>
<span><span class="co">#&gt; Lab4 - Lab3 == 0  0.006667 -2.996510  3.009843</span></span>
<span><span class="co">#&gt; Lab5 - Lab3 == 0  0.013333 -2.989843  3.016510</span></span>
<span><span class="co">#&gt; Lab6 - Lab3 == 0  0.570000 -2.433176  3.573176</span></span>
<span><span class="co">#&gt; Lab7 - Lab3 == 0 -0.993333 -3.996510  2.009843</span></span>
<span><span class="co">#&gt; Lab8 - Lab3 == 0  1.126667 -1.876510  4.129843</span></span>
<span><span class="co">#&gt; Lab5 - Lab4 == 0  0.006667 -2.996510  3.009843</span></span>
<span><span class="co">#&gt; Lab6 - Lab4 == 0  0.563333 -2.439843  3.566510</span></span>
<span><span class="co">#&gt; Lab7 - Lab4 == 0 -1.000000 -4.003176  2.003176</span></span>
<span><span class="co">#&gt; Lab8 - Lab4 == 0  1.120000 -1.883176  4.123176</span></span>
<span><span class="co">#&gt; Lab6 - Lab5 == 0  0.556667 -2.446510  3.559843</span></span>
<span><span class="co">#&gt; Lab7 - Lab5 == 0 -1.006667 -4.009843  1.996510</span></span>
<span><span class="co">#&gt; Lab8 - Lab5 == 0  1.113333 -1.889843  4.116510</span></span>
<span><span class="co">#&gt; Lab7 - Lab6 == 0 -1.563333 -4.566510  1.439843</span></span>
<span><span class="co">#&gt; Lab8 - Lab6 == 0  0.556667 -2.446510  3.559843</span></span>
<span><span class="co">#&gt; Lab8 - Lab7 == 0  2.120000 -0.883176  5.123176</span></span>
<span><span class="co">#&gt; $Models</span></span>
<span><span class="co">#&gt; $Models$`Material: A`</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;    aov(formula = y ~ laboratory, data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Terms:</span></span>
<span><span class="co">#&gt;                 laboratory Residuals</span></span>
<span><span class="co">#&gt; Sum of Squares     7.71520  18.08713</span></span>
<span><span class="co">#&gt; Deg. of Freedom          7        16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.063224</span></span>
<span><span class="co">#&gt; Estimated effects may be unbalanced</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Confidence</span></span>
<span><span class="co">#&gt; $Confidence$`Material: A`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simultaneous Confidence Intervals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fit: aov(formula = y ~ laboratory, data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quantile = 3.4594</span></span>
<span><span class="co">#&gt; 95% family-wise confidence level</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear Hypotheses:</span></span>
<span><span class="co">#&gt;                  Estimate  lwr       upr      </span></span>
<span><span class="co">#&gt; Lab2 - Lab1 == 0  0.156667 -2.846510  3.159843</span></span>
<span><span class="co">#&gt; Lab3 - Lab1 == 0  0.166667 -2.836510  3.169843</span></span>
<span><span class="co">#&gt; Lab4 - Lab1 == 0  0.173333 -2.829843  3.176510</span></span>
<span><span class="co">#&gt; Lab5 - Lab1 == 0  0.180000 -2.823176  3.183176</span></span>
<span><span class="co">#&gt; Lab6 - Lab1 == 0  0.736667 -2.266510  3.739843</span></span>
<span><span class="co">#&gt; Lab7 - Lab1 == 0 -0.826667 -3.829843  2.176510</span></span>
<span><span class="co">#&gt; Lab8 - Lab1 == 0  1.293333 -1.709843  4.296510</span></span>
<span><span class="co">#&gt; Lab3 - Lab2 == 0  0.010000 -2.993176  3.013176</span></span>
<span><span class="co">#&gt; Lab4 - Lab2 == 0  0.016667 -2.986510  3.019843</span></span>
<span><span class="co">#&gt; Lab5 - Lab2 == 0  0.023333 -2.979843  3.026510</span></span>
<span><span class="co">#&gt; Lab6 - Lab2 == 0  0.580000 -2.423176  3.583176</span></span>
<span><span class="co">#&gt; Lab7 - Lab2 == 0 -0.983333 -3.986510  2.019843</span></span>
<span><span class="co">#&gt; Lab8 - Lab2 == 0  1.136667 -1.866510  4.139843</span></span>
<span><span class="co">#&gt; Lab4 - Lab3 == 0  0.006667 -2.996510  3.009843</span></span>
<span><span class="co">#&gt; Lab5 - Lab3 == 0  0.013333 -2.989843  3.016510</span></span>
<span><span class="co">#&gt; Lab6 - Lab3 == 0  0.570000 -2.433176  3.573176</span></span>
<span><span class="co">#&gt; Lab7 - Lab3 == 0 -0.993333 -3.996510  2.009843</span></span>
<span><span class="co">#&gt; Lab8 - Lab3 == 0  1.126667 -1.876510  4.129843</span></span>
<span><span class="co">#&gt; Lab5 - Lab4 == 0  0.006667 -2.996510  3.009843</span></span>
<span><span class="co">#&gt; Lab6 - Lab4 == 0  0.563333 -2.439843  3.566510</span></span>
<span><span class="co">#&gt; Lab7 - Lab4 == 0 -1.000000 -4.003176  2.003176</span></span>
<span><span class="co">#&gt; Lab8 - Lab4 == 0  1.120000 -1.883176  4.123176</span></span>
<span><span class="co">#&gt; Lab6 - Lab5 == 0  0.556667 -2.446510  3.559843</span></span>
<span><span class="co">#&gt; Lab7 - Lab5 == 0 -1.006667 -4.009843  1.996510</span></span>
<span><span class="co">#&gt; Lab8 - Lab5 == 0  1.113333 -1.889843  4.116510</span></span>
<span><span class="co">#&gt; Lab7 - Lab6 == 0 -1.563333 -4.566510  1.439843</span></span>
<span><span class="co">#&gt; Lab8 - Lab6 == 0  0.556667 -2.446510  3.559843</span></span>
<span><span class="co">#&gt; Lab8 - Lab7 == 0  2.120000 -0.883176  5.123176</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="2-characterization-of-materials-by-thermogravimetric-analysis">2) Characterization of materials by thermogravimetric analysis<a class="anchor" aria-label="anchor" href="#2-characterization-of-materials-by-thermogravimetric-analysis"></a>
</h2>
<p><br></p>
<ul><li><strong>Graphical and functional analytical statistics</strong></li></ul>
<p>This exmample is about 7 (emulated) laboratories that analysed 15 samples of calcium oxalate by Thermogravimetric (TG) techniques, obtaining 105 TG curves that shows the mass loss of oxalate as a function of temperature when the oxalate samples were heated at 20◦C/min. The TG dataset contains the resulting values at 1000 discretization points, corresponding to temperatures ranging from 40◦C to 850◦C. Laboratories 1, 6, and 7 presented non-consistent results. In laboratory 1 a Simultaneous Thermal Analyzer (STA) was used with an out of phase calibration program. In laboratory 6, we used a simultaneous SDT analyser with an old calibration, and finally, in laboratory 7, we used a simultaneous SDT analyser with a bias in the the temperature calibration with respect to the real values (2◦C displaced with respect to the melting point of the zinc).</p>
<p>From the TG curves, a second set of data called IDT was obtained. The IDT (Initial Decomposition Temperature) is a parameter defined by the temperature at which the studied material losses the 5% of its weight when it is heated at a constant rate. The dataset is composed of the IDT values of the calcium oxalate samples analyzed by the 7 laboratories. It is an example of ILS study with scalar response, obtained by extracting just only one representative feature from the TG curve. It is important to stress that when a feature extraction process is performed, there is the risk of loosing relevant information and thus obtaining erroneous findings.</p>
<p>For the estimation of the functional statistics (for the performance of the graphical and analytical methods), the procedure is the same as for the scalar case. The ILS package provides the ils.fqcdata() function to generate the functional quality control data from a matrix (or a data.frame), in which each row represents a test result. The dimension of the matrix must be n×m, where n is the number of replicates performed by the laboratories that participate in the study, and m is the number of points observed in each curve. The usual methods were implemented to make plots and summaries of the resulting objects.</p>
<p><br></p>
<p>To create an object that contains the functional quality control data from the TG dataset, first we defined the grid in which the observations were obtained. In this case, the grid consists of 1000 temperature values ranging from 40◦C to 850◦C.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">TG</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">40</span>, to <span class="op">=</span> <span class="fl">850</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">fqcdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/ils.fqcdata.html" class="external-link">ils.fqcdata</a></span><span class="op">(</span><span class="va">TG</span>, p <span class="op">=</span> <span class="fl">7</span>, argvals <span class="op">=</span> <span class="va">delta</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fqcdata</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"TG curves of calcium oxalate"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Temperature (C)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Mass (%)"</span>,</span>
<span>     legend <span class="op">=</span> <span class="cn">TRUE</span>, x.co <span class="op">=</span> <span class="fl">20</span>, y.co <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_10-1.png" width="100%"></p>
<p>In the figure above, the TG curves are presented. The following commands create a fqcstat object containing the functional statistics from fqcdata, and plot it afterwards.</p>
<p><br></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fqcstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/ils.fqcs.html" class="external-link">ils.fqcs</a></span><span class="op">(</span><span class="va">fqcdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fqcstat</span>, xlab <span class="op">=</span> <span class="st">"Temperature (C)"</span>, ylab <span class="op">=</span> <span class="st">"Mass (%)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_11-1.png" width="100%"></p>
<p>The result is shown in this Figure. The plot() method creates a panel with four graphs, in the first row the functional means and variances for each laboratory are presented, while in the second row the global functional mean and variance are plotted.</p>
<p><br></p>
<ul><li><strong>Consistency tests</strong></li></ul>
<p>With the aim to perform a r&amp;R study of the TG and DSC functional datasets described in the previous section, the corresponding statistics H(t), K(t), dH and dK will be estimated and graphically represented. As above mentioned, the TG dataset contains thermogravimetric test results from 7 laboratories, while the DSC dataset contains results from 6 laboratories (excluding laboratory 1). Laboratories 1, 5 and 6 have provided different results from the remaining laboratories and should be detected as outliers.</p>
<p>Function mandel.fqcs() estimates the functional statistics Hl(t) and Kl(t), and the test statistics dKl and dHl, l = 1 . . . p. It also performs the bootstrap procedure described in [6] to approximate the cK and cH critical values, and to compute functional confidence bands for H(t) and K(t), under the corresponding null hypothesis. The results can be plotted with the default method.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">777</span><span class="op">)</span></span>
<span><span class="va">mandel.tg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/mandel.fqcs.html" class="external-link">mandel.fqcs</a></span><span class="op">(</span><span class="va">fqcdata</span>, nb <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mandel.tg</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_12-1.png" width="100%"></p>
<p>The left panels of the figure show the dKl and dHl test statistics for each laboratory, l = 1 . . . p, as well as the corresponding critical values cH and cK (horizontal lines), constructed at a significance level of α = 0.01. In the case of the dH statistic, it is concluded that laboratory 7 does not meet the reproducibility hypothesis (according with [6], laboratories 1, 6, and 7 were detected as outliers through an iterative process). When the repeatability hypothesis is tested by the dK test statistic, laboratory 6 is identified as an outlier in the first iteration.</p>
<p>The right panels of the figure show the functional statistics Hl(t) and Kl(t) for each laboratory, l = 1 . . . p, as well as the corresponding confidence bands (dotted lines in black). Functional estimates with a significant large test statistic are shown with a solid line. These functional estimates allow us to identify in which time intervals the laboratories provide different results. In this case, the differences between the laboratory 7 and the remaining are in the interval corresponding to the first degradation process of calcium oxalate.</p>
<p><br></p>
<ul><li><strong>Outliers detection</strong></li></ul>
<p>Finally, the ILS package is used to perform outlier detection tasks in the Interlaboratory Study defined by the DSC dataset.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DSC</span><span class="op">)</span></span>
<span><span class="va">fqcdata.dsc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/ils.fqcdata.html" class="external-link">ils.fqcdata</a></span><span class="op">(</span><span class="va">DSC</span>, p <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                           index.laboratory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Lab"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>                           argvals <span class="op">=</span> <span class="va">delta</span><span class="op">)</span></span>
<span><span class="va">mandel.dsc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ILS/man/mandel.fqcs.html" class="external-link">mandel.fqcs</a></span><span class="op">(</span><span class="va">fqcdata.dsc</span>,</span>
<span>                          nb <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mandel.dsc</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_13-1.png" width="100%"></p>
<p>The figure shows that repeatability hypothesis is not reject. Otherwise, the reproducibility hypothesis is rejected, and laboratory 6 is properly detected as an outlier (see top panels of the figure).</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>The ILS package has been implemented in R software with the aim to provide the main descriptive and outlier detection tools dealing with the Interlaboratory Studies and recommended by the ISO 5725-4-1994 and ASTM E-691 standards. Namely, Mandels’s h and k test (including their graphical output), Grubbs’ test, Cochran’s test, in addition to ANOVA utilities.</p>
<p>Moreover, apart from standard scalar statistical techniques, the ILS package provides FDA techniques to deal with functional data (curves), as data unit, in the framework of Interlaboratory Studies. Indeed, the main novelty of this computational proposal is the implementation of the functional extensions of the h and k Mandel’s statistics when data results are curves, preventing to lose relevant information derived from reduction dimension and feature extraction processes. These new methods can identify successfully the outlier laboratories directly from data curves.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/davidtorres1818/ILSR6V1/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/davidtorres1818/ILSR6V1/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ILSR6V1</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>David Cardenas <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by David Cardenas.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
